> Наверное это самый сложный пункт установки. Но если вы прошли все предыдущие - **вы точно разберетесь**

## Что такое ngrok и зачем он нужен

Ваш бэкенд (Victor API) живёт **на вашем компьютере** и доступен обычно по адресу вроде:

```text
http://127.0.0.1:8000
```

или

```text
http://localhost:8000
```

Ваше Android-приложение и web demo живут **не внутри этого компьютера** (телефон, другой браузер и т.п.) и **не умеют ходить в `localhost` на домашнем компе напрямую**.

Чтобы они могли безопасно общаться с вашим сервером, нужен:

* **публичный HTTPS-адрес** (что-то вроде `https://something.ngrok-free.app`),
* который «пробрасывает» запросы извне на ваш локальный порт `8000` (и при желании на порт web demo, например `5173`).

Именно это делает **ngrok**: он создаёт защищённый «туннель» между интернетом и вашим локальным сервером.

---

## Общая схема

Что вам предстоит сделать:

1. Зарегистрироваться на сайте **ngrok**.
2. Скачать и установить программу `ngrok`.
3. Добавить свой `authtoken` в конфиг.
4. Настроить файл конфигурации `ngrok.yml` / `ngrok.yaml` с туннелями:

   * для бэкенда (Victor API),
   * при желании — для web demo.
5. Запустить туннели.
6. Вставить полученный `https://...ngrok...` адрес:

   * в web demo,
   * и/или в Android-приложение.

---

## Шаг 1. Регистрация на ngrok

1. Перейдите на сайт: [https://ngrok.com/](https://ngrok.com/)
2. Нажмите **Sign up** (зарегистрироваться).
3. Создайте аккаунт:

   * можно через GitHub/Google,
   * или по почте и паролю.
4. После регистрации вы попадёте в личный кабинет (Dashboard).

Там вам пригодится:

* **Auth token** — строка вида `2yW...`
* Раздел **Setup & Installation** — там показано, как настроить ngrok под вашу систему.

---

## Шаг 2. Установка ngrok

### 2.1. Скачиваем ngrok

1. В Dashboard найдите раздел **Download** или вкладку с установкой для вашей ОС.
2. Выберите вашу платформу:

   * Windows,
   * macOS,
   * Linux.
3. Скачайте нужный архив/установщик.

### 2.2. Устанавливаем (общая логика)

Вариант для **Windows (проще всего)**:

1. Скачайте `.exe`-установщик, если он есть — запустите его.
2. Если скачался архив:

   * распакуйте его в папку, где обычно лежат программы,
   * желательно добавить путь к `ngrok.exe` в переменную PATH (при необходимости можно попросить ИИ-ассистента помочь по вашей системе:
     *«Я скачал ngrok для Windows, помоги добавить его в PATH»*).

Вариант для **macOS / Linux**:

* Обычно это:

  * `chmod +x ngrok`
  * переместить бинарник в `/usr/local/bin` или аналогичный каталог.
* Но тут проще всего сделать так:

  1. Скопировать команду установки с официальной страницы (там прямо даётся конкретная строка).
  2. Вставить в терминал.
  3. Выполнить.

Если что-то из этого звучит как магия — не стесняйтесь сразу звать ИИ и показывать, что вы скачали и куда.

---

## Шаг 3. Добавляем auth token

После установки нужно «привязать» локальный ngrok к вашему аккаунту.

1. В ngrok Dashboard найдите ваш **Auth token** (строка вида `2yW...`).
2. Откройте **терминал** / **PowerShell**.
3. Выполните команду, которую подсказывает Dashboard, обычно что-то вроде:

```bash
ngrok config add-authtoken 2yW................
```

После этого ngrok будет знать, кто вы, и вам станут доступны ваши туннели, лимиты и т.п.

---

## Шаг 4. Создаём конфиг ngrok

По умолчанию ngrok может работать и без явного конфига, но для вашего проекта удобнее завести **конфигурационный файл**, чтобы:

* каждый раз не вводить длинные команды,
* сразу запускать все нужные туннели (API + web demo).

### 4.1. Где лежит конфиг

Часто конфиг по умолчанию:

* Windows: `C:\Users\<Имя>\.ngrok2\ngrok.yml` или `C:\Users\<Имя>\.config\ngrok\ngrok.yml`
* macOS / Linux: `~/.config/ngrok/ngrok.yml` или `~/.ngrok2/ngrok.yml`

Если не знаете, где он — можно спросить у ИИ, указав вашу ОС, или посмотреть на странице Setup в Dashboard: там обычно написано, куда положить `ngrok.yml`.

### 4.2. Пример конфига для вашего проекта

Вот пример **готового** файла `ngrok.yml`:

```yaml
version: "3"
agent:
  authtoken: 2yW.....   # сюда вставьте СВОЙ токен из Dashboard

tunnels:
  victor-api:
    proto: http
    addr: 8000
    inspect: false
    request_header:
      add:
        - "X-Forwarded-For: $remote_addr"
    response_header:
      add:
        - "X-Accel-Buffering: no"
        - "Cache-Control: no-cache"

  victor-web:
    proto: http
    addr: 5173
    inspect: false
```

* Блок `victor-api` — это туннель для **бэкенда** (FastAPI/сервер Victor) на порту `8000`.
* Блок `victor-web` — это туннель для **web demo** (фронтенда) на порту `5173`.

Вам не обязательно использовать именно эти имена (`victor-api`, `victor-web`) — это просто удобные ярлыки.

### ❗❗❗ Важное ограничение бесплатного ngrok

В бесплатном тарифе ngrok у вас:

* фактически **один стабильный туннель одновременно**,
* плюс ограничения по количеству соединений.

Поэтому:

* Для первых шагов вам **достаточно одного туннеля** — к API (порт `8000`).
* Туннель для web demo (порт `5173`) можно добавить позже, если вы:

  * перейдёте на платный план, **или**
  * отдельно разберётесь с альтернативами (например, Cloudflare Tunnel).

Если вы попробуете запускать несколько туннелей на бесплатном плане, оно:

* либо не даст,
* либо будет работать нестабильно и с ограничениями.

---

Ваш `ngrok.yml` тогда будет выглядеть вот так: 

```yaml
tunnels:
  victor-api:
    proto: http
    addr: 8000
    inspect: false

  # Если вы на платном плане ngrok или используете альтернативу (Cloudflare),
  # можно раскомментировать и этот туннель:
  # victor-web:
  #   proto: http
  #   addr: 5173
  #   inspect: false
```

Как заставить web демо ходить на 8000, или что с этим делать - подскажет ИИ ассистент.  
android приложение спокойно ходит на 8000.  

---

## Шаг 5. Запуск туннелей

Когда конфиг готов, достаточно в терминале выполнить:

```bash
ngrok start --all
```

ngrok прочитает ваш `ngrok.yml` и запустит **оба** туннеля (`victor-api` и `victor-web`).

В терминале появятся строки вида:

```text
Forwarding  https://something.ngrok-free.app -> http://localhost:8000
Forwarding  https://something-else.ngrok-free.app -> http://localhost:5173
```

Вот эти адреса `https://something*.ngrok-free.app` вам и нужны.


> Если вы пользуетесь VPN по ряду жизненных обстоятельств, перед запуском Ngrok нужно запустить и его тоже.
> 

---

## Шаг 6. Куда вставлять ngrok-ссылку (пока никуда, просто запомните это место)

### 6.1. Web demo

В web demo нужно поменять базовый URL API.

Ищите файл:

```text
frontend/src/lib/api.ts
```

Там смотрите на:

* функцию `getApiBase()`
* и значение по умолчанию в `inferDefaultApiBase()`.

Вставьте туда **ваш** `https://...ngrok...` от туннеля `victor-api`.
(`Подробный гайд будет расписан на этапе установки web demo и доступен по ссылке: [ссылка]`.)

### 6.2. Android-приложение

В Android-проекте адрес бэкенда задаётся через:

* `app/build.gradle.kts`
* и/или корневой `gradle.properties`

Вам нужно найти строку вида:

```properties
API_BASE_URL=...
```

и заменить её на ваш актуальный `https://...ngrok...` (от туннеля `victor-api`).

Потом пересобрать приложение.
(`Подробный гайд будет расписан на этапе установки android и доступен по ссылке: [ссылка]`.)

---

## Важное про бесплатную версию ngrok

> ❗❗❗ В бесплатной версии ngrok **адрес меняется каждый раз**, когда вы перезапускаете туннели командой:
>
> ```bash
> ngrok start --all
> ```
>
> Это значит:
>
> * вам придётся **каждый раз**:
>
>   * копировать новый `https://...ngrok...`,
>   * вставлять его в web demo,
>   * при необходимости — в Android-приложение,
>   * пересобирать фронт/приложение.

### Когда этого достаточно

* Если вы **просто хотите поиграться** с промптами, механикой, логикой — бесплатного варианта достаточно.
* Для личного пользования и «пощупать проект» — этого вполне хватит.

### Когда этого становится мало

Примерно через месяц:

* вы либо устанете менять URL,
* либо выберете лимит.

Тогда придётся:

* либо заплатить около **$10** за тариф с постоянным доменом,
* либо разбираться, как поднять **Cloudflare Tunnel** или другой более серьёзный вариант.
  (Это отдельная, довольно большая история, и в этот гайд она намеренно не входит.)

---

## Если что-то пошло не так

Если вы:

* не нашли нужный файл `ngrok.yml`,
* не поняли, куда вставлять `authtoken`,
* запутались, как запускать `ngrok`,
* увидели ошибку в терминале,

**не паникуйте**. Скопируйте:

1. Текст шага из этого гайда, на котором вы застряли.
2. Текст ошибки (или скриншот, переписав, что там написано).
3. Опишите, что вы уже сделали (от регистрации до запуска).

И напишите любому ИИ-ассистенту (ChatGPT, Claude, Grok, DeepSeek и т.п.) что-то вроде:

> *«Я впервые настраиваю ngrok по этому гайду.
> Я застрял на шаге [номер шага].
> Вот текст шага и вот ошибка.
> Вот, что я уже сделал до этой ошибки.
> Помоги, пожалуйста, разобраться, что мне сделать дальше».*

Они отлично умеют проводить за руку через такие штуки.